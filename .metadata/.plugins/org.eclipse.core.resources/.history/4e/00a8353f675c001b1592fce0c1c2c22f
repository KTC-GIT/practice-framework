<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions"%>
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<c:set var="contextpath" value="${pageContext.request.contextPath}"/>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>아이디 비밀번호 찾기</title>
<style>
	ul,li{
		list-style:none;
		padding:5px;
	}
	#findId,#findPw:hover{
		cursor:pointer;
	}
	#findId,#findPw{
		font-size:20px;
		font-weight:bold;
	}
	#findId{
		background-color:#0A8A8A;
	}
	input[type="text"]{
		padding:10px;
	}
	#findPwContent{
		display:none;
	}
</style>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>
	var sw = 0;
	
	$(document).ready(function(){
		
		$("#findPw").click(function(){
			sw = 1;
			$("#findIdContent").hide();
			$("#findPwContent").show();
			$("#findId").css("background-color","transparent");
			$("#findPw").css("background-color","#0A8A8A");
		});
		
		$("#findId").click(function(){
			sw = 0;
			$("#findPwContent").hide();
			$("#findIdContent").show();
			$("#findPw").css("background-color","transparent");
			$("#findId").css("background-color","#0A8A8A");
		});
		
		$("#submitBtn").click(function(){
			if(sw==0){		//아이디찾기
				if($("#email").val()==""){
					alert("이메일을 입력하세요");
				}
				else{
					submitFunc();
				}
			}
			if(sw==1){		//비밀번호 찾기
				if($("#email").val()==""){
					alert("이메일을 입력하세요");
				}
				else if($("#id").val()==""){
					alert("아이디를 입력하세요");
				}
				else{
					submitFunc();
				}
			}
		});
	});
	function submitFunc(){
		var queryString = $("#findForm").serialize();
		
		$.ajax({
			type: "POST",
			url: "${contextpath}/member/find",
			data: queryString,
			success: function(result){
				if(result==1){
					alert("메일이 발송되었습니다. 임시비밀번호는 꼭 변경바랍니다.");
					location.href="${contextpath}/h";
				}
				else{
					alert("입력하신 내용이 일치하지 않습니다.");
				}
			},
			error: function(request,status,error){
				alert('code: '+request.status+'\n message: '+request.responseText+'\n error: '+error);
			}
		});
	}
</script>
</head>
<body>
<%@include file="/WEB-INF/views/include/nav.jsp" %>
<%@include file="/WEB-INF/views/include/slide.jsp" %>
<div class="w3-content w3-center" style="max-width:600px;height:300px;margin-top:25px;padding-bottom:20px;">
	<form id="findForm" method="POST">
		<div>
			<ul>
				<li>
					<span id="findId">아이디 찾기</span>&nbsp;|
					<span id="findPw">비밀번호 찾기</span>
				</li>
			</ul>
		</div>
		<div id="findIdContent">
			<ul>
				<li><input type="text" name="email" id="email" placeholder="가입당시 입력한 이메일"/></li>
			</ul>
		</div>
		<div id="findPwContent">
			<ul>
				<li><input type="text" name="id" id="id" placeholder="아이디 입력"/></li>
				<li><input type="text" name="email" id="email" placeholder="가입당시 입력한 이메일"/></li>
			</ul>
		</div>
		<div>
			<input type="button" value="찾기" id="submitBtn" class="w3-button w3-blue w3-section w3-center"/>
			<input type="button" value="취소" id="cancelBtn" class="w3-button w3-grey w3-section w3-center"/>
		</div>
	</form>
</div>
<%@include file="/WEB-INF/views/include/footer.jsp" %>
</body>
</html>